name = "livestore-filesync-vue-example"
main = "src/cf-worker/index.ts"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# This worker hosts:
# - the LiveStore sync durable object backend
# - a signer API used by @livestore-filesync/core
# - the direct file data plane backed by an R2 bucket binding (PUT/GET /livestore-filesync-files/:key)
#
# WORKER_AUTH_TOKEN is optional in local dev; if omitted, endpoints are unauthenticated.

[[r2_buckets]]
binding = "FILE_BUCKET"
bucket_name = "livestore-filesync-dev"

# Durable Object for LiveStore sync
[[durable_objects.bindings]]
name = "SYNC_BACKEND_DO"
class_name = "SyncBackendDO"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["SyncBackendDO"]

# WORKER_AUTH_TOKEN is set via .dev.vars for local dev
# For production, use `wrangler secret put WORKER_AUTH_TOKEN`
